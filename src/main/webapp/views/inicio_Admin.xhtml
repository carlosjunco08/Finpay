<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<body>

    <ui:composition template="./admin_Template.xhtml">

        <ui:define name="content">

          
            <h:messages id="mensajes"
                        globalOnly="true" 
                        showDetail="true" 
                        showSummary="true" 
                        style="color: white; font-weight: bold;" 
                        styleClass="alert alert-info mt-2"/>

            <div class="table-responsive-wrapper"> 
                <table border="1"  id="t-all" class="jsf-data-table display nowrap" width="100%">
                    <thead>
                        <tr>
<!--  BOTONES PERSONALIZADOS  -->
                            <th>
     
      <style>
         
         .btn-custom {
           display: inline-block;
           padding: 10px 18px;
           font-size: 14px;
           font-weight: 600;
           border: none;
           border-radius: 6px;
           cursor: pointer;
           transition: all 0.3s ease;
         }

       
         .btn-crear {
           background-color: #004080;
           color: #fff;
           margin-right: 10px; 
         }

         .btn-crear:hover {
           background-color: #0056b3;
           transform: translateY(-2px);
         }

     
         .btn-pdf {
           background-color: #dc3545; 
           color: #fff;
         }

         .btn-pdf:hover {
           background-color: #a71d2a;
           transform: translateY(-2px);
         }
         
         
         .btn-correo {
           background-color: #27F5AD; 
           color: #fff;
         }
         
         .btn-correo:hover {
           background-color: #04B376;
           transform: translateY(-2px);
         }
      </style>

      <!-- Botones -->
      <h:form style="display:inline-block; ">
         <h:commandButton value="Crear Usuarios"
                          action="#{usuariosController.crearUsuarioPartOne()}"
                          styleClass="btn-custom btn-crear">
            <f:ajax execute="@form" render="modalForm mensajes" onevent="abrirModalUsuario" />
         </h:commandButton>
      </h:form>

      <h:form style="display:inline-block; ">
         <h:commandButton value="Generar PDF de Usuarios"
                          action="#{usuariosController.generarPdfUsuarios}"
                          styleClass="btn-custom btn-pdf"/>
      </h:form>
      <h:form style="display:inline-block;">
         <h:commandButton value="Envio de correos"
                          action="enviarCorreos.xhtml"
                          styleClass="btn-custom btn-correo"/>
      </h:form>
   </th>
</tr>


                        <tr>
                            <th>Rol</th>
                            <th>Nombre de Usuario</th>      
                            <th>Nombres</th>
                            <th>Apellidos</th>
                            <th>Identificación</th>
                            <th>Email</th>
                            <th>Teléfono</th>
                            <th>Dirección</th>
                            <th>Edad</th>
                            <th>País</th>
                            <th>Estado</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    
                    <tbody>
                        <ui:repeat value="#{usuariosController.listarUsuarios()}" var="user">
                            <tr>
                                <td>#{user.rolId.nombreRol}</td>
                                <td>#{user.nombreUsuario}</td>
                                <td>#{user.nombres}</td>
                                <td>#{user.apellidos}</td>
                                <td>#{user.identificacion}</td>
                                <td>#{user.correo}</td>
                                <td>#{user.telefono}</td>
                                <td>#{user.direccion}</td>
                                <td>#{user.edad}</td>
                                <td>#{user.paisId.nombrePais}</td>
                                <!-- ✅ Estado corregido -->
                                <td>#{user.rolId.estadoRolId.estadoRol}</td>
                                <td>
                                    <h:form>
                                        <h:commandButton value="Editar"
                                                         action="#{usuariosController.editarUserOne(user)}"
                                                         styleClass="btn-custom btn-editar">
                                            <f:ajax execute="@form" render="modalForm mensajes" onevent="abrirModalUsuario" />
                                        </h:commandButton>

                                        <h:commandButton value="Eliminar"
                                                         action="#{usuariosController.eliminar(user)}"
                                                         styleClass="btn-custom btn-eliminar">
                                            <f:ajax execute="@this" render="formUsuarios mensajes" />
                                        </h:commandButton>
                                    </h:form>
                                </td>
                            </tr>
                        </ui:repeat>
                    </tbody>
                    
                </table>

             
                <h:form id="csvForm" enctype="multipart/form-data">
                    <h:panelGroup>
                        <h:inputFile id="csvFile"
                                     value="#{usuariosController.archivoCsv}"
                                     styleClass="form-control"
                                     required="true" />
                        <h:commandButton value="Cargar Usuarios"
                                         action="#{usuariosController.cargarUsuariosDesdeCsv}"
                                         styleClass="btn btn-success mt-2"
                                         />
                    </h:panelGroup>
                </h:form>

            </div>
            
          
            <h:form id="modalForm">
                ...
            </h:form>

        </ui:define>

    </ui:composition>

</body>
</html>
